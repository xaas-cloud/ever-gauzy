<!-- State variables -->
<!-- Whether a plugin is being installed -->
@let installing = installationQuery.installing$() | async;

<!-- Whether a plugin is being uninstalled -->
@let uninstalling = installationQuery.uninstalling$() | async;

<!-- Whether a plugin is being activated -->
@let activating = query.activating$ | async;

<!-- Whether a plugin is being deactivated -->
@let deactivating = query.deactivating$ | async;

<!-- Whether any operation is in progress -->
@let disabled = installing || uninstalling || activating || deactivating;

<!-- The currently selected plugin -->
@let selected = query.plugin$ | async;

<!-- Whether the plugins are loading -->
@let loading = query.isLoading$ | async;

<!-- The source data for the table -->
@let source = sourceData$ | async;

<!-- The list of plugins -->
@let plugins = plugins$ | async;

<!-- Whether there are any plugins available -->
@let isPluginAvailable = plugins && plugins.length > 0;

<section class="content-active first" aria-label="Plugin List">
	<!-- Content States -->
	@if (loading) {
	<!-- Loading State -->
	<div class="no-data" aria-live="polite" aria-busy="true">
		<ngx-no-data-message [message]="'SM_TABLE.NO_DATA.LOADING' | translate"></ngx-no-data-message>
	</div>
	} @else if (isPluginAvailable) {
	<!-- Action Buttons -->
	@if (selected) {
	<div class="button-container" aria-label="Plugin actions">
		<div class="button-hide">
			@if (selected.renderer) {
			<button
				class="action secondary"
				status="basic"
				size="small"
				(click)="view()"
				[disabled]="disabled"
				[attr.aria-disabled]="disabled"
				aria-label="View plugin details"
				nbButton
			>
				<nb-icon icon="eye-outline"></nb-icon>
				<span class="btn-text">{{ 'BUTTONS.VIEW' | translate }}</span>
			</button>
			}
			<button
				size="small"
				[status]="selected.isActivate ? 'warning' : 'primary'"
				class="button-status"
				(click)="changeStatus()"
				[disabled]="disabled"
				[attr.aria-disabled]="disabled"
				[attr.aria-label]="(selected.isActivate ? 'Deactivate' : 'Activate') + ' plugin'"
				nbButton
			>
				<nb-icon
					*gauzySpinnerButton="activating || deactivating"
					[icon]="selected.isActivate ? 'close-circle-outline' : 'checkmark-circle-outline'"
				></nb-icon>
				<span class="btn-text">{{
					(selected.isActivate ? 'BUTTONS.DEACTIVATE' : 'BUTTONS.ACTIVATE') | translate
				}}</span>
			</button>
			<button
				size="small"
				class="action danger"
				status="basic"
				(click)="uninstall()"
				[disabled]="disabled"
				[attr.aria-disabled]="disabled"
				aria-label="Uninstall plugin"
				nbButton
			>
				<nb-icon *gauzySpinnerButton="uninstalling" status="danger" icon="slash-outline"></nb-icon>
				<span class="btn-text">{{ 'BUTTONS.UNINSTALL' | translate }}</span>
			</button>
		</div>
	</div>
	}
	<!-- Table View -->
	<div class="custom-table" aria-label="Plugins table">
		<div class="table-scroll-container">
			@if (source) {
			<angular2-smart-table
				#pluginTable
				(userRowSelect)="handleRowSelection($event)"
				[settings]="smartTableSettings"
				[source]="source"
				[class.table-disabled]="disabled"
				[attr.aria-disabled]="disabled"
			></angular2-smart-table>
			}
		</div>
		@if (source) {
		<nav class="pagination-container" aria-label="Table pagination">
			<ga-pagination [source]="source"></ga-pagination>
		</nav>
		}
	</div>
	} @else {
	<!-- Empty State -->
	<div class="no-data" aria-live="polite">
		<ngx-no-data-message [message]="'SM_TABLE.NO_DATA.PLUGIN' | translate"></ngx-no-data-message>
	</div>
	}
</section>
