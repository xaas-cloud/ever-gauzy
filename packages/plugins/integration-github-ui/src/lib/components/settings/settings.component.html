<nb-card
  [nbSpinner]="loading"
  nbSpinnerStatus="primary"
  nbSpinnerSize="small"
  >
  <div class="popover-container">
    <div class="d-flex justify-content-end w-100">
      <span (click)="cancel($event)" class="cursor">
        <i class="fas fa-times"></i>
      </span>
    </div>
    <div class="d-flex justify-content-start w-100 mb-2">
      <span class="title">
        {{ 'INTEGRATIONS.SETTINGS' | translate }}
      </span>
    </div>
    <div class="d-flex justify-content-start w-100">
      @if (entitiesToSync$ | async; as entitiesToSync) {
        <div class="switcher-wrapper">
          @for (entity of entitiesToSync.currentValue; track entity) {
            <nb-toggle
              [(checked)]="entity.sync"
              labelPosition="start"
              status="basic"
              >
              {{ entity.entity }}
            </nb-toggle>
            <div class="tied-entities-wrapper">
              @for (tiedEntity of entity.tiedEntities; track tiedEntity) {
                <div class="tied-entity">
                  <nb-toggle
                    [(checked)]="tiedEntity.sync"
                    [disabled]="!entity.sync"
                    labelPosition="start"
                    status="basic"
                    >
                    {{ tiedEntity.entity }}
                  </nb-toggle>
                </div>
              }
            </div>
          }
        </div>
      }
    </div>
    <div class="d-flex justify-content-end w-100">
      <button
        nbButton
        status="primary"
        class="mr-2"
        (click)="saveIntegrationSettings()"
        >
        {{ 'BUTTONS.SAVE' | translate }}
      </button>
    </div>
  </div>
</nb-card>
