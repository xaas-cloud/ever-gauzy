<div class="row col-auto main-wrapper">
  <div class="col-auto ml-auto">
    <div class="row filter-item-list align-items-end">
      @if (hasTimeZoneFilter) {
        <div class="col-auto single-filter-wrapper">
          <ga-timezone-filter
            [isTimeFormat]="isTimeFormat"
            (timeFormatChange)="timeFormatChanged($event)"
            (timeZoneChange)="timeZoneChanged($event)"
          ></ga-timezone-filter>
        </div>
      }
      @if (hasSourceFilter) {
        <div class="col-auto filter-item single-filter-wrapper">
          <nb-select
            multiple
            [placeholder]="'TIMESHEET.SELECT_SOURCE' | translate"
            [(selected)]="filters.source"
            (selectedChange)="triggerFilterChange()"
            >
            @for (source of timeLogSourceSelectors; track source) {
              <nb-option [value]="source.value">
                {{ source.label | replace : '_' : ' ' | titlecase }}
              </nb-option>
            }
          </nb-select>
        </div>
      }
      @if (hasActivityLevelFilter) {
        <div class="col-auto filter-item single-filter-wrapper">
          <button
            class="activity-level-filter text-capitalize"
            nbButton
            status="basic"
            outline
            nbPopoverPlacement="bottom"
            [nbPopover]="activityLevelSliderTemplate"
            nbPopoverTrigger="click"
            >
            @if (activityLevel?.start > 0 || activityLevel?.end < 100) {
              <span
                >
                {{ 'TIMESHEET.ACTIVITY_LEVEL' | translate }} : {{ activityLevel?.start }}% -
                {{ activityLevel?.end }}%
              </span>
            } @else {
              {{ 'TIMESHEET.SELECT_ACTIVITY_LEVEL' | translate }}
            }
            <nb-icon icon="chevron-down-outline"></nb-icon>
          </button>
        </div>
      }
      @if (hasLogTypeFilter) {
        <div class="col-auto filter-item single-filter-wrapper">
          <nb-select
            multiple
            [placeholder]="'TIMESHEET.SELECT_LOG_TYPE' | translate"
            [(selected)]="filters.logType"
            (selectedChange)="triggerFilterChange()"
            >
            @for (logType of TimeLogType | keyvalue; track logType) {
              <nb-option [value]="logType.key">
                {{ logType.value | titlecase }}
              </nb-option>
            }
          </nb-select>
        </div>
      }
      @if (hasFilterApplies) {
        <div class="col-auto single-filter-wrapper clear-fitlers">
          <button nbButton status="danger" (click)="clearFilters()">
            {{ 'BUTTONS.CLEAR' | translate }}
          </button>
        </div>
      }
    </div>
  </div>
</div>

<ng-template #activityLevelSliderTemplate>
  <div class="p-3 slider-dropdown">
    <ngx-slider
      [value]="activityLevel?.start"
      [highValue]="activityLevel?.end"
      (userChange)="setActivityLevel($event)"
      [options]="sliderOptions"
    ></ngx-slider>
  </div>
</ng-template>
